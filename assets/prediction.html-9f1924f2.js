import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as s,c as a,e as p}from"./app-e7e54c71.js";const t={},e=p(`<h1 id="prediction" tabindex="-1"><a class="header-anchor" href="#prediction" aria-hidden="true">#</a> Prediction</h1><p>有时理解模型的最佳方法是查看其预测而不是其参数。</p><p>我们使用预测可以</p><ul><li>Data on explanatory values to predict: 将预测出的 属性值数据(y) 和 原本的真实数据 进行对比，以直观判断预测是否准确</li><li>Extrapolating means making predictions outside the range of observed data: 用于新的数据的预测</li></ul><p>实质上就是带入x 求y的值</p><h2 id="使用回归进行新数据预测" tabindex="-1"><a class="header-anchor" href="#使用回归进行新数据预测" aria-hidden="true">#</a> 使用回归进行新数据预测</h2><p>对于之前<code>smf.olt</code>得到的<code>results</code>，将一个新的dataframe带入其中</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># realinc ~ educ + educ2 + age + age2</span>

<span class="token comment"># 创建新的df</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 打算预测学龄为12岁的各年龄段的人的收入</span>
df<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">&#39;age2&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span><span class="token operator">**</span><span class="token number">2</span>
df<span class="token punctuation">[</span><span class="token string">&#39;educ&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">12</span>
df<span class="token punctuation">[</span><span class="token string">&#39;educ2&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;educ&#39;</span><span class="token punctuation">]</span><span class="token operator">**</span><span class="token number">2</span>

<span class="token comment"># 预测求解y，得到 pred12，一个新的series，包括每一行的 income</span>
pred12 <span class="token operator">=</span> results<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token comment"># 可视化预测数据</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pred12<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;High school&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 可视化原始数据</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>mean_income_by_age<span class="token punctuation">,</span> <span class="token string">&#39;o&#39;</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
<span class="token comment"># 由于原始数据和预测数据的x轴是一致的，有对比的意义，因此可放到一张图上</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://pic.hanjiaming.com.cn/2022/06/09/f206390254be9.png" alt="1654761163311.png" tabindex="0" loading="lazy"><figcaption>1654761163311.png</figcaption></figure><p>接着，我们也预测 学龄为14岁 和 学龄为16岁的各年龄段的人的收入</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">[</span><span class="token string">&#39;educ&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">14</span>
df<span class="token punctuation">[</span><span class="token string">&#39;educ2&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;educ&#39;</span><span class="token punctuation">]</span><span class="token operator">**</span><span class="token number">2</span>
pred14 <span class="token operator">=</span> results<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pred14<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;Associate&#39;</span><span class="token punctuation">)</span>

df<span class="token punctuation">[</span><span class="token string">&#39;educ&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">16</span>
df<span class="token punctuation">[</span><span class="token string">&#39;educ2&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;educ&#39;</span><span class="token punctuation">]</span><span class="token operator">**</span><span class="token number">2</span>
pred16 <span class="token operator">=</span> results<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pred16<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;Bachelor&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://pic.hanjiaming.com.cn/2022/06/09/ecfb91d17aa86.png" alt="1654761269126.png" tabindex="0" loading="lazy"><figcaption>1654761269126.png</figcaption></figure><h2 id="使用回归进行原始数据预测" tabindex="-1"><a class="header-anchor" href="#使用回归进行原始数据预测" aria-hidden="true">#</a> 使用回归进行原始数据预测</h2><p>尽管是对旧的数据进行预测，我们依旧不可直接使用原数据，因为源数据太大，会导致过度采样。</p><p>因此我们不妨和上面一样，新建一个df，参照着原始数据。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># Run a regression model with educ, educ2, age, and age2</span>
results <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span><span class="token string">&#39;realinc ~ educ + educ2 + age + age2&#39;</span><span class="token punctuation">,</span> data<span class="token operator">=</span>gss<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Make the DataFrame</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">&#39;educ&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">&#39;educ2&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;educ&#39;</span><span class="token punctuation">]</span><span class="token operator">**</span><span class="token number">2</span>
df<span class="token punctuation">[</span><span class="token string">&#39;age2&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span><span class="token operator">**</span><span class="token number">2</span>

<span class="token comment"># Generate and plot the predictions</span>
pred <span class="token operator">=</span> results<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pred<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment"># Plot mean income in each age group</span>
plt<span class="token punctuation">.</span>clf<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 对于原始数据，通常只取每个年龄段的income的平均值，防止过度取样</span>
grouped <span class="token operator">=</span> gss<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;educ&#39;</span><span class="token punctuation">)</span>
mean_income_by_educ <span class="token operator">=</span> grouped<span class="token punctuation">[</span><span class="token string">&#39;realinc&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>mean_income_by_educ<span class="token punctuation">,</span> <span class="token string">&#39;o&#39;</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>

<span class="token comment"># Plot the predictions</span>
pred <span class="token operator">=</span> results<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;educ&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pred<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;Age 30&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># Label axes</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;Education (years)&#39;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;Income (1986 $)&#39;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://pic.hanjiaming.com.cn/2022/06/09/7d1f82b7efbef.png" alt="1654762732062.png" style="zoom:50%;"><p>总的来说，还可以。</p><div class="hint-container tip"><p class="hint-container-title">predict(df)</p><p>df 不必是一列，因为在ols中指定了列名，保持自变量的列名一致也是可以的。</p></div>`,19),c=[e];function o(i,l){return s(),a("div",null,c)}const d=n(t,[["render",o],["__file","prediction.html.vue"]]);export{d as default};
